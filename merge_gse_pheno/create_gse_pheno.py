import numpy as np
import pandas as pd

from collections import OrderedDict

gse_header = OrderedDict(
    [
        ("samples", np.str),
        ("GSM2402854_5684819014_R03C02", np.float64),
        ("GSM2402859_5684819014_R01C02", np.float64),
        ("GSM2402860_5911815001_R04C01", np.float64),
        ("GSM2402862_5911815001_R02C01", np.float64),
        ("GSM2402867_5684819013_R05C01", np.float64),
        ("GSM2402870_5684819026_R01C02", np.float64),
        ("GSM2402876_6164621155_R05C02", np.float64),
        ("GSM2402877_6164621081_R06C02", np.float64),
        ("GSM2402878_6164621131_R02C02", np.float64),
        ("GSM2402880_6164621081_R04C02", np.float64),
        ("GSM2402882_6164621131_R02C01", np.float64),
        ("GSM2402883_6164621131_R05C02", np.float64),
        ("GSM2403087_6229017111_R06C01", np.float64),
        ("GSM2403088_6229017103_R06C01", np.float64),
        ("GSM2403089_6229017111_R01C02", np.float64),
        ("GSM2403090_6229017111_R02C02", np.float64),
        ("GSM2403091_6229017111_R04C02", np.float64),
        ("GSM2403092_6229017120_R01C01", np.float64),
        ("GSM2403093_6229017120_R02C01", np.float64),
        ("GSM2403094_6229017120_R04C01", np.float64),
        ("GSM2403095_6229017120_R05C01", np.float64),
        ("GSM2403096_6229017120_R02C02", np.float64),
        ("GSM2403097_6229017103_R03C02", np.float64),
        ("GSM2403098_6229017103_R04C01", np.float64),
        ("GSM2403099_6229017111_R01C01", np.float64),
        ("GSM2403100_6229017103_R05C01", np.float64),
        ("GSM2403101_6229017111_R04C01", np.float64),
        ("GSM2403102_6229017111_R05C01", np.float64),
        ("GSM2403103_6929793058_R01C01", np.float64),
        ("GSM2403104_6929793058_R02C01", np.float64),
        ("GSM2403105_6969568010_R04C01", np.float64),
        ("GSM2403106_6969568010_R01C01", np.float64),
        ("GSM2403107_6969568010_R02C01", np.float64),
        ("GSM2403108_6969568010_R03C01", np.float64),
        ("GSM2403109_6969568010_R05C02", np.float64),
        ("GSM2403110_6969568010_R02C02", np.float64),
        ("GSM2403111_6969568010_R04C02", np.float64),
        ("GSM2403113_6969568103_R03C02", np.float64),
        ("GSM2403114_6969568103_R06C01", np.float64),
        ("GSM2403116_6969568103_R02C02", np.float64),
        ("GSM2403118_6969568103_R05C01", np.float64),
        ("GSM2403120_6285641004_R02C02", np.float64),
        ("GSM2403121_6285641004_R05C01", np.float64),
        ("GSM2403122_6285641005_R05C01", np.float64),
        ("GSM2403123_6285641005_R01C01", np.float64),
        ("GSM2403124_6285641005_R06C01", np.float64),
        ("GSM2403125_6285641004_R06C01", np.float64),
        ("GSM2403190_6929806024_R02C02", np.float64),
        ("GSM2403425_8622007029_R06C02", np.float64),
        ("GSM2403471_8622007011_R01C01", np.float64),
        ("GSM2403472_8622007019_R04C01", np.float64),
        ("GSM2403473_8622007011_R03C01", np.float64),
        ("GSM2403474_8622007019_R05C01", np.float64),
        ("GSM2403475_8622007019_R06C01", np.float64),
        ("GSM2403476_8622007011_R05C02", np.float64),
        ("GSM2403477_8622007013_R02C01", np.float64),
        ("GSM2403478_8622007013_R04C01", np.float64),
        ("GSM2403479_8622007013_R01C02", np.float64),
        ("GSM2403480_8622007013_R05C02", np.float64),
        ("GSM2403481_8622007013_R06C02", np.float64),
        ("GSM2403482_8622007014_R02C01", np.float64),
        ("GSM2403483_8622007014_R06C01", np.float64),
        ("GSM2403484_8622007014_R02C02", np.float64),
        ("GSM2403485_8622007014_R04C02", np.float64),
        ("GSM2403486_8622007019_R06C02", np.float64),
        ("GSM2403487_8622007020_R02C01", np.float64),
        ("GSM2403488_8622007020_R06C01", np.float64),
        ("GSM2403489_8622007063_R01C01", np.float64),
        ("GSM2403597_8622007144_R03C02", np.float64),
        ("GSM2403598_8622007144_R01C02", np.float64),
        ("GSM2403604_8622007144_R04C02", np.float64),
        ("GSM2403648_8942326114_R02C02", np.float64),
        ("GSM2403649_8942326114_R05C02", np.float64),
        ("GSM2403650_8942326114_R03C02", np.float64),
        ("GSM2403668_8963311098_R02C01", np.float64),
        ("GSM2403669_8963282018_R03C02", np.float64),
        ("GSM2403670_8959312010_R03C01", np.float64),
        ("GSM2403671_8963311098_R05C01", np.float64),
        ("GSM2403672_8959312010_R06C01", np.float64),
        ("GSM2403673_8963282018_R01C01", np.float64),
        ("GSM2403674_8963282039_R02C01", np.float64),
        ("GSM2403675_8963282062_R03C01", np.float64),
        ("GSM2403676_8963282039_R05C02", np.float64),
        ("GSM2403677_8963282062_R01C02", np.float64),
        ("GSM2403678_8959312010_R04C01", np.float64),
        ("GSM2403679_8963282039_R06C01", np.float64),
        ("GSM2403680_8963282046_R05C01", np.float64),
        ("GSM2403682_8963282018_R01C02", np.float64),
        ("GSM2403683_8963282062_R04C01", np.float64),
        ("GSM2403684_8963282018_R02C02", np.float64),
        ("GSM2403685_8963282062_R06C02", np.float64),
        ("GSM2403688_8963282062_R02C01", np.float64),
        ("GSM2403689_8963311098_R02C02", np.float64),
        ("GSM2403690_8963311098_R04C01", np.float64),
        ("GSM2403691_8963282046_R03C01", np.float64),
        ("GSM2403693_9007217139_R02C02", np.float64),
        ("GSM2403696_9007217139_R01C02", np.float64),
        ("GSM2403697_9007217139_R03C02", np.float64),
        ("GSM2403724_9007225082_R05C02", np.float64),
        ("GSM2403729_9221197135_R04C01", np.float64),
        ("GSM2403738_9007225086_R02C02", np.float64),
        ("GSM2403740_9007225163_R05C02", np.float64),
        ("GSM2403748_9007225163_R01C02", np.float64),
        ("GSM2403896_9297949146_R06C02", np.float64),
        ("GSM2404023_9340996014_R04C02", np.float64),
        ("GSM2404025_9340996014_R05C01", np.float64),
        ("GSM2404026_9340996014_R02C01", np.float64),
        ("GSM2404042_9373550164_R05C02", np.float64),
        ("GSM2404056_9373551023_R03C02", np.float64),
        ("GSM2404067_9374341006_R04C02", np.float64),
        ("GSM2404131_9406921073_R04C01", np.float64),
        ("GSM2404132_9406921073_R06C01", np.float64),
        ("GSM2404137_9406922158_R06C01", np.float64),
        ("GSM2404200_9376561024_R03C01", np.float64),
        ("GSM2404208_9379082092_R03C02", np.float64),
        ("GSM2404287_9407201028_R01C02", np.float64),
        ("GSM2404344_9407210003_R06C01", np.float64),
        ("GSM2404366_9407210090_R01C02", np.float64),
        ("GSM2404368_9407210090_R04C02", np.float64),
        ("GSM2404480_9444374134_R02C01", np.float64),
        ("GSM2404486_9444375019_R04C01", np.float64),
        ("GSM2404487_9444375019_R05C01", np.float64),
        ("GSM2404488_9444375004_R06C01", np.float64),
        ("GSM2404489_9444375004_R01C02", np.float64),
        ("GSM2404491_9444375004_R05C02", np.float64),
        ("GSM2404493_9444375014_R03C01", np.float64),
        ("GSM2404499_9444375017_R01C01", np.float64),
        ("GSM2404500_9444375017_R03C01", np.float64),
        ("GSM2404518_9444375037_R04C02", np.float64),
        ("GSM2404527_9444375114_R06C01", np.float64),
        ("GSM2404528_9444374168_R06C02", np.float64),
        ("GSM2404539_9610361003_R05C02", np.float64),
        ("GSM2404546_9553932029_R05C02", np.float64),
        ("GSM2404569_9611518113_R02C02", np.float64),
        ("GSM2404570_9611518110_R04C02", np.float64),
        ("GSM2404571_9611518113_R01C02", np.float64),
        ("GSM2404573_9611518110_R05C02", np.float64),
        ("GSM2404574_9611518113_R03C01", np.float64),
        ("GSM2404577_9611518099_R06C01", np.float64),
        ("GSM2404579_9611518099_R03C02", np.float64),
        ("GSM2404580_9611518099_R04C02", np.float64),
        ("GSM2404582_9611518109_R01C02", np.float64),
        ("GSM2404592_9611518116_R01C02", np.float64),
        ("GSM2404593_9611518117_R06C02", np.float64),
        ("GSM2404597_9611518116_R01C01", np.float64),
        ("GSM2404598_9611518117_R05C01", np.float64),
        ("GSM2404600_9611518116_R02C02", np.float64),
        ("GSM2404602_9611518117_R01C02", np.float64),
        ("GSM2404603_9611518117_R04C01", np.float64),
        ("GSM2404604_9611518115_R03C02", np.float64),
        ("GSM2404613_9741950008_R06C02", np.float64),
        ("GSM2404614_9741950021_R02C01", np.float64),
        ("GSM2404617_9741950021_R01C02", np.float64),
        ("GSM2404628_9741950008_R02C02", np.float64),
        ("GSM2404631_9721365095_R06C01", np.float64),
        ("GSM2404632_9721365095_R02C01", np.float64),
        ("GSM2404633_9721365103_R03C01", np.float64),
        ("GSM2404634_9721365105_R01C01", np.float64),
        ("GSM2404635_9721365137_R03C01", np.float64),
        ("GSM2404636_9721365103_R01C01", np.float64),
        ("GSM2404637_9721365095_R03C02", np.float64),
        ("GSM2404640_9721365104_R02C02", np.float64),
        ("GSM2404641_9721365137_R06C01", np.float64),
        ("GSM2404642_9721365103_R03C02", np.float64),
        ("GSM2404645_9721365105_R05C02", np.float64),
        ("GSM2404647_9721365137_R03C02", np.float64),
        ("GSM2404648_9741950025_R05C01", np.float64),
        ("GSM2404652_9741950030_R01C01", np.float64),
        ("GSM2404654_9741950099_R02C01", np.float64),
        ("GSM2404659_9741950109_R06C01", np.float64),
        ("GSM2404661_9741950109_R02C02", np.float64),
        ("GSM2404662_9741950109_R03C02", np.float64),
        ("GSM2404666_9741950099_R01C02", np.float64),
        ("GSM2404667_9741950099_R04C02", np.float64),
        ("GSM2404670_9741950100_R06C01", np.float64),
        ("GSM2404671_9741950100_R02C02", np.float64),
        ("GSM2404672_9741950100_R04C02", np.float64),
        ("GSM2404674_9741950100_R06C02", np.float64),
        ("GSM2404685_9741950075_R01C01", np.float64),
        ("GSM2404686_9647455008_R06C01", np.float64),
        ("GSM2404687_9647455008_R02C02", np.float64),
        ("GSM2404701_9513149129_R05C01", np.float64),
        ("GSM2404702_9513149129_R02C02", np.float64),
        ("GSM2404714_9721366149_R05C01", np.float64),
        ("GSM2404715_9721366149_R02C02", np.float64),
        ("GSM2404716_9721366150_R01C01", np.float64),
        ("GSM2404736_9741779119_R06C01", np.float64),
        ("GSM2404738_9741779119_R05C02", np.float64),
        ("GSM2404815_9533774046_R05C01", np.float64),
        ("GSM2404827_9533774033_R05C01", np.float64),
        ("GSM2404829_9533774033_R05C02", np.float64),
        ("GSM2404830_9533774041_R03C01", np.float64),
        ("GSM2404846_9533774088_R02C01", np.float64),
        ("GSM2404848_9533774097_R01C01", np.float64),
        ("GSM2404868_9534104007_R04C01", np.float64),
        ("GSM2404869_9534104007_R02C02", np.float64),
        ("GSM2404870_9534104007_R03C02", np.float64),
        ("GSM2404872_9534104008_R02C02", np.float64),
        ("GSM2404874_9534104008_R06C02", np.float64),
        ("GSM2404876_9534104010_R02C01", np.float64),
        ("GSM2404891_9968646118_R03C02", np.float64),
        ("GSM2404905_9968646167_R05C02", np.float64),
        ("GSM2404911_9968646164_R06C02", np.float64),
        ("GSM2404912_9968646165_R02C01", np.float64),
        ("GSM2404923_9969477014_R02C02", np.float64),
        ("GSM2404995_9969477031_R06C02", np.float64),
        ("GSM2404998_9969477017_R04C02", np.float64),
        ("GSM2404999_9969477018_R03C01", np.float64),
        ("GSM2405000_9969477018_R05C02", np.float64),
        ("GSM2405001_9969477022_R01C01", np.float64),
        ("GSM2405003_9969477022_R04C01", np.float64),
        ("GSM2405005_9969477032_R06C01", np.float64),
        ("GSM2405006_9969477031_R04C01", np.float64),
        ("GSM2405007_9969477029_R03C02", np.float64),
        ("GSM2405008_9969477031_R04C02", np.float64),
        ("GSM2405009_9969477029_R06C02", np.float64),
        ("GSM2405025_9969477058_R03C01", np.float64),
        ("GSM2405026_9969477058_R05C01", np.float64),
        ("GSM2405027_9969477063_R02C02", np.float64),
        ("GSM2405028_9969477064_R01C02", np.float64),
        ("GSM2405030_9969477064_R06C02", np.float64),
        ("GSM2405031_9969477065_R01C01", np.float64),
        ("GSM2405036_9969477074_R06C01", np.float64),
        ("GSM2405037_9969477074_R03C02", np.float64),
        ("GSM2405055_9969477086_R01C01", np.float64),
        ("GSM2405056_9969477086_R03C02", np.float64),
        ("GSM2405058_9969477088_R05C01", np.float64),
        ("GSM2405059_9969477088_R02C02", np.float64),
        ("GSM2405060_9969477088_R06C02", np.float64),
        ("GSM2405067_9969477100_R06C01", np.float64),
        ("GSM2405069_9969477100_R02C02", np.float64),
        ("GSM2405074_9969477101_R02C02", np.float64),
        ("GSM2405077_9969477102_R06C02", np.float64),
        ("GSM2405087_9969477121_R05C01", np.float64),
        ("GSM2405088_9969477121_R01C01", np.float64),
        ("GSM2405104_9855358001_R06C01", np.float64),
        ("GSM2405110_9855358032_R01C01", np.float64),
        ("GSM2405111_9855358032_R03C01", np.float64),
        ("GSM2405112_9855358026_R03C01", np.float64),
        ("GSM2405115_9855358026_R01C02", np.float64),
        ("GSM2405130_9855358058_R05C02", np.float64),
        ("GSM2405131_9855358065_R05C02", np.float64),
        ("GSM2405132_9855358065_R01C01", np.float64),
        ("GSM2405133_9855358066_R02C02", np.float64),
        ("GSM2405134_9855358068_R03C01", np.float64),
        ("GSM2405135_9855358065_R03C02", np.float64),
        ("GSM2405136_9855358066_R02C01", np.float64),
        ("GSM2405138_9855358068_R05C01", np.float64),
        ("GSM2405140_9855358065_R05C01", np.float64),
        ("GSM2405142_9878820008_R06C01", np.float64),
        ("GSM2405143_9878820030_R04C02", np.float64),
        ("GSM2405148_9878820018_R01C01", np.float64),
        ("GSM2405149_9878820018_R03C01", np.float64),
        ("GSM2405150_9878820018_R03C02", np.float64),
        ("GSM2405151_9878820018_R06C02", np.float64),
        ("GSM2405157_9878820030_R01C01", np.float64),
        ("GSM2405162_9878820078_R05C02", np.float64),
        ("GSM2405163_9878820082_R05C02", np.float64),
        ("GSM2405164_9878820082_R04C02", np.float64),
        ("GSM2405165_9878820082_R06C01", np.float64),
        ("GSM2405166_9878820082_R02C02", np.float64),
        ("GSM2405167_9878820083_R06C02", np.float64),
        ("GSM2405168_9878820084_R01C02", np.float64),
        ("GSM2405169_9878820083_R05C02", np.float64),
        ("GSM2405176_9878820091_R01C02", np.float64),
        ("GSM2405177_9878820106_R06C01", np.float64),
        ("GSM2405179_9878820106_R06C02", np.float64),
        ("GSM2405180_9878820104_R06C01", np.float64),
        ("GSM2405187_9878820105_R02C02", np.float64),
        ("GSM2405188_9878820105_R03C02", np.float64),
        ("GSM2405189_9878820119_R01C01", np.float64),
        ("GSM2405190_9878820117_R06C02", np.float64),
        ("GSM2405194_9878820117_R04C02", np.float64),
        ("GSM2405200_9878820119_R02C02", np.float64),
        ("GSM2405212_9878820127_R06C01", np.float64),
        ("GSM2405213_9878820156_R06C02", np.float64),
        ("GSM2405214_9878820140_R03C01", np.float64),
        ("GSM2405217_9878820140_R05C02", np.float64),
        ("GSM2405222_9980102013_R01C01", np.float64),
        ("GSM2405227_9878827210_R05C01", np.float64),
        ("GSM2405245_9878827221_R05C02", np.float64),
        ("GSM2405246_9878827225_R02C01", np.float64),
        ("GSM2405265_9878827235_R05C02", np.float64),
        ("GSM2405270_10006823022_R03C02", np.float64),
        ("GSM2405272_10006823069_R02C01", np.float64),
        ("GSM2405273_10006823069_R04C02", np.float64),
        ("GSM2405280_10006823122_R05C02", np.float64),
        ("GSM2405281_10006823123_R02C01", np.float64),
        ("GSM2405290_10006823141_R01C02", np.float64),
        ("GSM2405296_3999875055_R02C01", np.float64),
        ("GSM2405297_3999875055_R01C02", np.float64),
        ("GSM2405306_3999875057_R05C01", np.float64),
        ("GSM2405309_10003886259_R03C01", np.float64),
        ("GSM2405311_10003886258_R06C01", np.float64),
        ("GSM2405313_10003886252_R04C02", np.float64),
        ("GSM2405317_10003886256_R01C02", np.float64),
        ("GSM2405320_10003886258_R02C02", np.float64),
        ("GSM2405324_10006823144_R02C01", np.float64),
        ("GSM2405325_10006823144_R01C02", np.float64),
        ("GSM2405328_10006823155_R03C02", np.float64),
        ("GSM2405329_10006823155_R04C02", np.float64),
        ("GSM2405331_3999834021_R04C02", np.float64),
        ("GSM2405333_3999834021_R05C01", np.float64),
        ("GSM2405373_3999834063_R05C02", np.float64),
        ("GSM2405375_3999834068_R03C02", np.float64),
        ("GSM2405376_3999834070_R01C01", np.float64),
        ("GSM2405377_3999834070_R01C02", np.float64),
        ("GSM2405380_3999834089_R06C01", np.float64),
        ("GSM2405383_3999834092_R06C02", np.float64),
        ("GSM2405388_3999834094_R04C01", np.float64),
        ("GSM2405427_3999834104_R04C01", np.float64),
        ("GSM2405428_3999834105_R02C01", np.float64),
        ("GSM2405433_3999834118_R01C02", np.float64),
        ("GSM2405437_3999875071_R01C01", np.float64),
        ("GSM2405439_3999875073_R02C01", np.float64),
        ("GSM2405443_3999875076_R06C01", np.float64),
        ("GSM2405444_3999875115_R01C01", np.float64),
        ("GSM2405445_3999875115_R02C01", np.float64),
        ("GSM2405446_3999875115_R01C02", np.float64),
        ("GSM2405453_3999543050_R02C02", np.float64),
        ("GSM2405457_3999547142_R02C02", np.float64),
        ("GSM2405463_3999100033_R01C01", np.float64),
        ("GSM2405465_3999100033_R06C02", np.float64),
        ("GSM2405466_3999100034_R06C01", np.float64),
        ("GSM2405467_3999100034_R03C02", np.float64),
        ("GSM2405470_3999100065_R06C02", np.float64),
        ("GSM2405472_3999112130_R01C02", np.float64),
        ("GSM2405473_3999112130_R02C02", np.float64),
        ("GSM2405477_3999112136_R06C02", np.float64),
        ("GSM2405478_3999112137_R02C01", np.float64),
        ("GSM2405489_3999308200_R01C01", np.float64),
        ("GSM2405490_3999308200_R06C01", np.float64),
        ("GSM2405498_3999308203_R02C02", np.float64),
        ("GSM2405499_3999308203_R05C02", np.float64),
        ("GSM2405500_3999112158_R04C01", np.float64),
        ("GSM2405503_3999543047_R05C02", np.float64),
        ("GSM2405505_3999547085_R02C01", np.float64),
        ("GSM2405544_3998909073_R04C01", np.float64),
        ("GSM2405559_3998952004_R02C01", np.float64),
        ("GSM2405560_3998952004_R02C02", np.float64),
        ("GSM2405561_3998952003_R04C02", np.float64),
        ("GSM2405580_3999002049_R05C02", np.float64),
        ("GSM2405581_3999002049_R06C02", np.float64),
        ("GSM2405582_3999002051_R01C01", np.float64),
        ("GSM2405583_3999002051_R04C01", np.float64),
        ("GSM2405584_3999002051_R05C01", np.float64),
        ("GSM2405642_101231000030_R03C02", np.float64),
        ("GSM2940725_10003886252_R05C02", np.float64),
        ("GSM2940727_10003886253_R03C02", np.float64),
        ("GSM2940729_10003886253_R04C02", np.float64),
        ("GSM2940732_10003886256_R05C02", np.float64),
        ("GSM2940734_10003886258_R01C01", np.float64),
        ("GSM2940735_10003886258_R01C02", np.float64),
        ("GSM2940736_10003886258_R03C02", np.float64),
        ("GSM2940737_10003886258_R04C02", np.float64),
        ("GSM2940740_10003886259_R01C01", np.float64),
        ("GSM2940742_10006823022_R05C02", np.float64),
        ("GSM2940749_10006823024_R04C02", np.float64),
        ("GSM2940756_10006823069_R04C01", np.float64),
        ("GSM2940757_10006823069_R05C01", np.float64),
        ("GSM2940764_10006823122_R03C01", np.float64),
        ("GSM2940765_10006823122_R04C01", np.float64),
        ("GSM2940767_10006823123_R02C02", np.float64),
        ("GSM2940769_10006823123_R04C02", np.float64),
        ("GSM2940772_10006823130_R01C02", np.float64),
        ("GSM2940775_10006823130_R06C02", np.float64),
        ("GSM2940778_10006823141_R02C01", np.float64),
        ("GSM2940779_10006823141_R03C01", np.float64),
        ("GSM2940786_10006823144_R04C01", np.float64),
        ("GSM2940787_10006823144_R04C02", np.float64),
        ("GSM2940805_101231000009_R02C01", np.float64),
        ("GSM2940806_101231000009_R03C01", np.float64),
        ("GSM2940807_101231000009_R04C01", np.float64),
        ("GSM2940808_101231000009_R05C01", np.float64),
        ("GSM2940810_101231000014_R04C01", np.float64),
        ("GSM2940812_200277210030_R05C01", np.float64),
        ("GSM2940813_200277210056_R01C01", np.float64),
        ("GSM2940818_200277210056_R04C02", np.float64),
        ("GSM2940820_200277210056_R05C02", np.float64),
        ("GSM2940822_200277210073_R01C01", np.float64),
        ("GSM2940838_200325530024_R05C01", np.float64),
        ("GSM2940842_200325530048_R05C01", np.float64),
        ("GSM2940850_200325530166_R01C01", np.float64),
        ("GSM2940855_200325530166_R05C01", np.float64),
        ("GSM2940856_200325530166_R05C02", np.float64),
        ("GSM2940858_200360420061_R05C02", np.float64),
        ("GSM2940863_200360420062_R06C01", np.float64),
        ("GSM2940872_200362700196_R01C02", np.float64),
        ("GSM2940876_200362700196_R04C01", np.float64),
        ("GSM2940882_200394870010_R01C02", np.float64),
        ("GSM2940883_200394870010_R03C01", np.float64),
        ("GSM2940897_200394970064_R01C01", np.float64),
        ("GSM2940898_200394970064_R02C01", np.float64),
        ("GSM2940913_200400320088_R01C01", np.float64),
        ("GSM2940917_200400320088_R03C02", np.float64),
        ("GSM2940922_200406080086_R02C01", np.float64),
        ("GSM2940928_200486890026_R01C02", np.float64),
        ("GSM2940932_3998523002_R05C02", np.float64),
        ("GSM2940938_3998523018_R04C02", np.float64),
        ("GSM2940941_3998523019_R03C02", np.float64),
        ("GSM2940949_3998523030_R02C02", np.float64),
        ("GSM2940967_3998523056_R02C01", np.float64),
        ("GSM2940968_3998523056_R02C02", np.float64),
        ("GSM2940971_3998523056_R05C02", np.float64),
        ("GSM2940972_3998523056_R06C01", np.float64),
        ("GSM2940974_3998523057_R01C01", np.float64),
        ("GSM2940979_3998523057_R05C01", np.float64),
        ("GSM2940983_3998523058_R01C01", np.float64),
        ("GSM2940985_3998523058_R03C01", np.float64),
        ("GSM2940986_3998546128_R01C02", np.float64),
        ("GSM2940988_3998546128_R02C02", np.float64),
        ("GSM2940990_3998546128_R03C02", np.float64),
        ("GSM2940991_3998546128_R04C01", np.float64),
        ("GSM2940994_3998546128_R06C02", np.float64),
        ("GSM2940995_3998546129_R01C01", np.float64),
        ("GSM2940997_3998546129_R02C01", np.float64),
        ("GSM2941001_3998546129_R04C01", np.float64),
        ("GSM2941002_3998546129_R04C02", np.float64),
        ("GSM2941007_3998546133_R01C01", np.float64),
        ("GSM2941008_3998546133_R03C01", np.float64),
        ("GSM2941009_3998546133_R04C01", np.float64),
        ("GSM2941015_3998567085_R04C02", np.float64),
        ("GSM2941016_3998567085_R05C02", np.float64),
        ("GSM2941017_3998567085_R06C01", np.float64),
        ("GSM2941018_3998567087_R02C01", np.float64),
        ("GSM2941020_3998567087_R04C01", np.float64),
        ("GSM2941022_3998567087_R05C02", np.float64),
        ("GSM2941027_3998567088_R04C01", np.float64),
        ("GSM2941033_3998568166_R01C01", np.float64),
        ("GSM2941036_3998568166_R03C01", np.float64),
        ("GSM2941045_3998568167_R04C01", np.float64),
        ("GSM2941046_3998909013_R02C02", np.float64),
        ("GSM2941053_3998909027_R04C01", np.float64),
        ("GSM2941058_3998909050_R05C02", np.float64),
        ("GSM2941060_3998909051_R03C01", np.float64),
        ("GSM2941065_3998909062_R02C01", np.float64),
        ("GSM2941071_3998909070_R02C02", np.float64),
        ("GSM2941072_3998909070_R03C02", np.float64),
        ("GSM2941074_3998909072_R01C02", np.float64),
        ("GSM2941076_3998909072_R03C02", np.float64),
        ("GSM2941077_3998909072_R04C01", np.float64),
        ("GSM2941078_3998909072_R04C02", np.float64),
        ("GSM2941085_3998909075_R02C02", np.float64),
        ("GSM2941086_3998909075_R03C02", np.float64),
        ("GSM2941094_3998909174_R04C02", np.float64),
        ("GSM2941099_3998909181_R03C02", np.float64),
        ("GSM2941105_3998909182_R04C02", np.float64),
        ("GSM2941106_3998909182_R05C01", np.float64),
        ("GSM2941108_3998909182_R06C02", np.float64),
        ("GSM2941110_3998919099_R01C01", np.float64),
        ("GSM2941115_3998919099_R06C02", np.float64),
        ("GSM2941116_3998920094_R01C01", np.float64),
        ("GSM2941117_3998920094_R02C01", np.float64),
        ("GSM2941120_3998920120_R03C01", np.float64),
        ("GSM2941126_3998998159_R01C02", np.float64),
        ("GSM2941128_3998998159_R03C01", np.float64),
        ("GSM2941131_3998998159_R04C02", np.float64),
        ("GSM2941132_3998998159_R05C01", np.float64),
        ("GSM2941140_3998998164_R05C01", np.float64),
        ("GSM2941143_3998998187_R02C01", np.float64),
        ("GSM2941150_3999002044_R03C01", np.float64),
        ("GSM2941156_3999002049_R01C01", np.float64),
        ("GSM2941158_3999002049_R02C01", np.float64),
        ("GSM2941164_3999002051_R02C02", np.float64),
        ("GSM2941165_3999078079_R01C01", np.float64),
        ("GSM2941167_3999078079_R02C02", np.float64),
        ("GSM2941171_3999078080_R04C02", np.float64),
        ("GSM2941172_3999078080_R05C02", np.float64),
        ("GSM2941174_3999078119_R01C01", np.float64),
        ("GSM2941176_3999078119_R05C02", np.float64),
        ("GSM2941178_3999078120_R02C02", np.float64),
        ("GSM2941187_3999078123_R02C02", np.float64),
        ("GSM2941192_3999078159_R05C02", np.float64),
        ("GSM2941193_3999078159_R06C01", np.float64),
        ("GSM2941201_3999095104_R01C01", np.float64),
        ("GSM2941210_3999100100_R03C02", np.float64),
        ("GSM2941215_3999100101_R03C01", np.float64),
        ("GSM2941218_3999100101_R06C02", np.float64),
        ("GSM2941225_3999543050_R04C01", np.float64),
        ("GSM2941233_3999547142_R01C02", np.float64),
        ("GSM2941234_3999547142_R03C02", np.float64),
        ("GSM2941239_3999834001_R02C02", np.float64),
        ("GSM2941244_3999834003_R01C02", np.float64),
        ("GSM2941257_3999834068_R04C01", np.float64),
        ("GSM2941258_3999834068_R04C02", np.float64),
        ("GSM2941260_3999834068_R06C01", np.float64),
        ("GSM2941261_3999834068_R06C02", np.float64),
        ("GSM2941262_3999834070_R02C02", np.float64),
        ("GSM2941266_3999834070_R05C01", np.float64),
        ("GSM2941267_3999834070_R06C01", np.float64),
        ("GSM2941268_3999834093_R05C02", np.float64),
        ("GSM2941270_3999834094_R03C01", np.float64),
        ("GSM2941275_3999834104_R03C01", np.float64),
        ("GSM2941281_3999834115_R02C01", np.float64),
        ("GSM2941284_3999834118_R05C02", np.float64),
        ("GSM2941287_3999875055_R05C01", np.float64),
        ("GSM2941288_3999875055_R06C01", np.float64),
        ("GSM2941290_3999875056_R01C01", np.float64),
        ("GSM2941292_3999875056_R02C01", np.float64),
        ("GSM2941293_3999875056_R02C02", np.float64),
        ("GSM2941296_3999875057_R02C01", np.float64),
        ("GSM2941298_3999875071_R01C02", np.float64),
        ("GSM2941300_3999875071_R04C01", np.float64),
        ("GSM2941302_3999875071_R05C01", np.float64),
        ("GSM2941310_3999875073_R06C02", np.float64),
        ("GSM2941320_9297949046_R05C01", np.float64),
        ("GSM2941321_9297949139_R05C02", np.float64),
        ("GSM2941325_9305651060_R06C02", np.float64),
        ("GSM2941335_9370847051_R01C02", np.float64),
        ("GSM2941336_9370847051_R02C02", np.float64),
        ("GSM2941338_9373550131_R02C01", np.float64),
        ("GSM2941344_9373551042_R04C02", np.float64),
        ("GSM2941345_9373551042_R05C02", np.float64),
        ("GSM2941363_9379082039_R04C01", np.float64),
        ("GSM2941365_9379082092_R04C01", np.float64),
        ("GSM2941368_9379086132_R02C01", np.float64),
        ("GSM2941371_9406921039_R03C01", np.float64),
        ("GSM2941372_9406921039_R05C02", np.float64),
        ("GSM2941373_9406921039_R06C02", np.float64),
        ("GSM2941385_9406922161_R01C01", np.float64),
        ("GSM2941386_9406922161_R01C02", np.float64),
        ("GSM2941398_9420867051_R04C01", np.float64),
        ("GSM2941401_9420867121_R02C02", np.float64),
        ("GSM2941402_9420867121_R03C02", np.float64),
        ("GSM2941406_9422491056_R02C01", np.float64),
        ("GSM2941407_9422493146_R04C01", np.float64),
        ("GSM2941411_9426021175_R03C02", np.float64),
        ("GSM2941414_9444374133_R04C01", np.float64),
        ("GSM2941418_9444375028_R01C02", np.float64),
        ("GSM2941422_9444375033_R04C02", np.float64),
        ("GSM2941424_9444375037_R01C01", np.float64),
        ("GSM2941427_9444375113_R01C01", np.float64),
        ("GSM2941430_9444375114_R05C02", np.float64),
        ("GSM2941436_9513149129_R01C02", np.float64),
        ("GSM2941439_9513149129_R03C02", np.float64),
        ("GSM2941447_9533774021_R01C02", np.float64),
        ("GSM2941450_9533774023_R02C02", np.float64),
        ("GSM2941457_9533774033_R04C02", np.float64),
        ("GSM2941459_9533774033_R06C02", np.float64),
        ("GSM2941460_9533774041_R01C01", np.float64),
        ("GSM2941462_9533774088_R02C02", np.float64),
        ("GSM2941463_9533774088_R03C02", np.float64),
        ("GSM2941468_9533774097_R05C01", np.float64),
        ("GSM2941469_9534104007_R01C02", np.float64),
        ("GSM2941473_9534104007_R06C01", np.float64),
        ("GSM2941475_9534104008_R01C02", np.float64),
        ("GSM2941478_9534104008_R03C02", np.float64),
        ("GSM2941480_9534104008_R05C01", np.float64),
        ("GSM2941481_9534104008_R06C01", np.float64),
        ("GSM2941484_9534104010_R05C01", np.float64),
        ("GSM2941487_9553932002_R06C02", np.float64),
        ("GSM2941488_9553932008_R01C01", np.float64),
        ("GSM2941489_9553932008_R02C01", np.float64),
        ("GSM2941491_9553932008_R04C01", np.float64),
        ("GSM2941493_9553932029_R02C01", np.float64),
        ("GSM2941496_9553932030_R06C01", np.float64),
        ("GSM2941500_9553932054_R04C01", np.float64),
        ("GSM2941506_9611519051_R01C01", np.float64),
        ("GSM2941510_9647455131_R05C02", np.float64),
        ("GSM2941511_9647455131_R06C02", np.float64),
        ("GSM2941525_9721366149_R01C02", np.float64),
        ("GSM2941528_9721366149_R04C01", np.float64),
        ("GSM2941532_9721366150_R02C01", np.float64),
        ("GSM2941533_9721366150_R02C02", np.float64),
        ("GSM2941537_9741779119_R02C01", np.float64),
        ("GSM2941538_9741779119_R02C02", np.float64),
        ("GSM2941541_9741779119_R04C01", np.float64),
        ("GSM2941546_9741950008_R02C01", np.float64),
        ("GSM2941558_9741950085_R02C01", np.float64),
        ("GSM2941561_9741950085_R03C02", np.float64),
        ("GSM2941562_9741950085_R04C01", np.float64),
        ("GSM2941566_9741950095_R02C01", np.float64),
        ("GSM2941567_9741950095_R02C02", np.float64),
        ("GSM2941568_9741950095_R03C01", np.float64),
        ("GSM2941569_9741950095_R03C02", np.float64),
        ("GSM2941572_9741950095_R05C02", np.float64),
        ("GSM2941587_9855358001_R04C01", np.float64),
        ("GSM2941588_9855358003_R01C01", np.float64),
        ("GSM2941589_9855358003_R01C02", np.float64),
        ("GSM2941591_9855358003_R03C01", np.float64),
        ("GSM2941594_9855358026_R02C02", np.float64),
        ("GSM2941595_9855358026_R04C02", np.float64),
        ("GSM2941601_9855358031_R02C01", np.float64),
        ("GSM2941602_9855358031_R03C01", np.float64),
        ("GSM2941604_9855358056_R03C01", np.float64),
        ("GSM2941605_9855358056_R03C02", np.float64),
        ("GSM2941608_9855358058_R02C02", np.float64),
        ("GSM2941609_9855358058_R03C02", np.float64),
        ("GSM2941613_9878820008_R02C02", np.float64),
        ("GSM2941615_9878820008_R04C01", np.float64),
        ("GSM2941616_9878820008_R05C01", np.float64),
        ("GSM2941617_9878820017_R01C01", np.float64),
        ("GSM2941618_9878820017_R02C01", np.float64),
        ("GSM2941620_9878820017_R06C02", np.float64),
        ("GSM2941621_9878820018_R01C02", np.float64),
        ("GSM2941622_9878820018_R02C01", np.float64),
        ("GSM2941625_9878820018_R04C02", np.float64),
        ("GSM2941632_9878820066_R01C01", np.float64),
        ("GSM2941633_9878820121_R01C01", np.float64),
        ("GSM2941637_9878820123_R03C01", np.float64),
        ("GSM2941640_9878820127_R01C02", np.float64),
        ("GSM2941645_9878820140_R04C01", np.float64),
        ("GSM2941648_9878820156_R01C01", np.float64),
        ("GSM2941651_9878820156_R02C02", np.float64),
        ("GSM2941653_9878820156_R03C02", np.float64),
        ("GSM2941654_9878820156_R05C01", np.float64),
        ("GSM2941657_9878827209_R04C02", np.float64),
        ("GSM2941658_9878827209_R06C02", np.float64),
        ("GSM2941660_9878827210_R01C02", np.float64),
        ("GSM2941662_9878827210_R02C02", np.float64),
        ("GSM2941663_9878827210_R03C01", np.float64),
        ("GSM2941668_9878827210_R06C01", np.float64),
        ("GSM2941670_9878827225_R01C02", np.float64),
        ("GSM2941672_9878827225_R04C01", np.float64),
        ("GSM2941687_9878827239_R06C02", np.float64),
        ("GSM2941688_9878827240_R01C01", np.float64),
        ("GSM2941695_9968646118_R03C01", np.float64),
        ("GSM2941696_9968646118_R04C01", np.float64),
        ("GSM2941697_9968646118_R04C02", np.float64),
        ("GSM2941698_9968646118_R05C01", np.float64),
        ("GSM2941700_9968646118_R06C02", np.float64),
        ("GSM2941701_9968646164_R01C01", np.float64),
        ("GSM2941702_9968646164_R01C02", np.float64),
        ("GSM2941703_9968646164_R02C02", np.float64),
        ("GSM2941704_9968646164_R03C02", np.float64),
        ("GSM2941707_9968646165_R02C02", np.float64),
        ("GSM2941710_9968646165_R05C01", np.float64),
        ("GSM2941712_9968646165_R06C02", np.float64),
        ("GSM2941717_9969477013_R02C02", np.float64),
        ("GSM2941719_9969477013_R04C01", np.float64),
        ("GSM2941722_9969477013_R06C01", np.float64),
        ("GSM2941725_9969477014_R04C01", np.float64),
        ("GSM2941726_9969477014_R04C02", np.float64),
        ("GSM2941728_9969477014_R06C01", np.float64),
        ("GSM2941730_9969477017_R01C01", np.float64),
        ("GSM2941731_9969477017_R02C02", np.float64),
        ("GSM2941732_9969477017_R03C01", np.float64),
        ("GSM2941733_9969477017_R04C01", np.float64),
        ("GSM2941738_9969477022_R02C01", np.float64),
        ("GSM2941741_9969477022_R06C01", np.float64),
        ("GSM2941746_9969477055_R04C01", np.float64),
        ("GSM2941750_9969477057_R03C01", np.float64),
        ("GSM2941753_9969477058_R02C01", np.float64),
        ("GSM2941754_9969477058_R04C01", np.float64),
        ("GSM2941756_9969477064_R05C02", np.float64),
        ("GSM2941757_9969477064_R06C01", np.float64),
        ("GSM2941758_9969477065_R01C02", np.float64),
        ("GSM2941759_9969477065_R02C02", np.float64),
        ("GSM2941761_9969477065_R06C01", np.float64),
        ("GSM2941768_9969477074_R06C02", np.float64),
        ("GSM2941770_9969477079_R04C01", np.float64),
        ("GSM2941771_9969477079_R06C01", np.float64),
        ("GSM2941773_9969477086_R02C01", np.float64),
        ("GSM2941781_9969477088_R03C01", np.float64),
        ("GSM2941783_9969477088_R05C02", np.float64),
        ("GSM2941784_9969477088_R06C01", np.float64),
        ("GSM2941786_9969477100_R04C01", np.float64),
        ("GSM2941790_9969477102_R02C01", np.float64),
        ("GSM2941794_9969477102_R05C01", np.float64),
        ("GSM2941796_9969477104_R01C01", np.float64),
        ("GSM2941799_9969477107_R03C02", np.float64),
        ("GSM2941802_9969477108_R01C01", np.float64),
        ("GSM2941807_9969477122_R04C01", np.float64),
        ("GSM2941812_9969477123_R05C01", np.float64),
        ("GSM2941813_9969477123_R05C02", np.float64),
        ("GSM2941814_9969477123_R06C02", np.float64),
        ("GSM2941816_9980102013_R01C02", np.float64),
        ("GSM2941817_9980102013_R02C01", np.float64),
        ("GSM2941818_9980102013_R02C02", np.float64),
        ("GSM2941819_9980102013_R03C01", np.float64),
        ("GSM2941820_9980102013_R03C02", np.float64)
    ]
)

gse = "/home/watson/george/master-degree/GSE109381/GSE109381_bvalues_gbm.csv"
csv = "/home/watson/george/master-degree/GSE109381/GBM_class_sample_2cols.csv"
sex = "/home/watson/george/master-degree/GSE109381/idat/major/samplesheet_GSE109381_simple.csv"
smoker = "/home/watson/george/master-degree/GSE109381/idat/major/epismoker_GSE109381.csv"
output = gse.replace(".csv", "_pheno_class.csv")

# csv
csv_df = pd.read_csv(csv, names=["samples", "class"])
csv_df["class"] = pd.Categorical(csv_df["class"])
csv_df["class_num"] = csv_df["class"].cat.codes
# csv_df.to_csv("/home/watson/george/master-degree/GSE109381/GBM_class_sample_categories.csv", index=False)
classes = csv_df[["samples", "class_num"]]

# smoker and sex
sex_df = pd.read_csv(sex)
sex_df.rename(columns={"Unnamed: 0": "samples"}, inplace=True)
sex_df["samples"] = [sample.split("_")[0] for sample in sex_df["samples"]]

smoker_df = pd.read_csv(smoker)
smoker_df.rename(columns={"SampleName": "samples"}, inplace=True)
smoker_df["samples"] = [sample.split("_")[0] for sample in smoker_df["samples"]]

pheno_df = sex_df.merge(smoker_df, on="samples")
pheno_df["PredictedSmokingStatus"] = pheno_df["PredictedSmokingStatus"].replace(
    {"Former Smoker": 1,
    "Current Smoker": 2,
    "Never Smoker": 3})
pheno_df = pheno_df[["samples", "sex", "PredictedSmokingStatus"]]
classes_pheno_df = pheno_df.merge(classes, on="samples")
classes_pheno_df = classes_pheno_df.set_index("samples")
# Sex (1=M, 2=F)

# gse
# the majority class is "GBM, RTK II" that now is 5
reader = pd.read_csv(
    gse, header=0,
    names=gse_header.keys(),
    dtype=gse_header,
    chunksize=20000)

chunks = []
# header=True

for gse_df in reader:
    gse_df = gse_df.set_index(["samples"]).transpose()
    gse_df[gse_df <= 0.2] = 0
    gse_df[gse_df >= 0.8] = 2
    gse_df[(gse_df > 0.2) & (gse_df < 0.8)] = 1
    gse_df = gse_df.astype(np.int64)
    gse_df = gse_df.reset_index().rename(columns={"index": "samples"})
    gse_df["samples"] = gse_df["samples"].apply(lambda sample: sample.split("_")[0])
    gse_df = gse_df.set_index("samples")
    chunks.append(gse_df)
    
# create output
merge_chunks_df = pd.concat(chunks, axis=1)
# merge
merged_df = merge_chunks_df.merge(classes_pheno_df, left_index=True, right_index=True)
merged_df.to_csv(output, index=False)
