import pandas as pd

file = "GSE109381_bvalues_gbm_merged_classes_formatted_nopoints.csv"
csv = "/home/watson/george/master-degree/GSE109381/GBM_class_sample_categories.csv"

# similiridade de 50
## subgrupo 1
### cg00002593 = 1,cg08398233 = 0,cg16573901 = 0,cg00068503 = 0,cg02756545 = 0,cg09106948 = 0,cg18887033 = 1,cg09917591 = 2,cg27591920 = 1,cg03455424 = 1,cg10914710 = 1,cg19719391 = 1,cg00070383 = 1,cg14115785 = 2,cg07666840 = 0,cg21567625 = 0,cg18197332 = 1,cg19338277 = 0,cg02639080 = 2,cg11930353 = 2,cg07028914 = 1,cg03958979 = 0,cg02645408 = 1,cg00684125 = 1,cg05769086 = 1,cg22469355 = 0,cg19978669 = 0,cg15893356 = 1,cg22537597 = 1,cg24794833 = 1,cg17021218 = 0,cg24466610 = 1,cg06757048 = 2,cg16214573 = 0,cg18048953 = 1,cg10856812 = 1,cg27150598 = 1,cg21604611 = 1,cg16563691 = 1,cg06452665 = 1,cg23004758 = 0,cg09387229 = 1,cg05342987 = 0,cg06924081 = 1,cg04105230 = 1,cg06467207 = 1,cg03533472 = 0,cg02783918 = 1,cg00164282 = 1,cg10692118 = 0,cg23163279 = 0,cg10632342 = 1,cg26237255 = 2,cg08692423 = 0,cg16483867 = 0
# cols = ["class_num", "cg00002593", "cg08398233", "cg16573901", "cg00068503", "cg02756545", "cg09106948", "cg18887033", "cg09917591", "cg27591920", "cg03455424", "cg10914710", "cg19719391", "cg00070383", "cg14115785", "cg07666840", "cg21567625", "cg18197332", "cg19338277", "cg02639080", "cg11930353", "cg07028914", "cg03958979", "cg02645408", "cg00684125", "cg05769086", "cg22469355", "cg19978669", "cg15893356", "cg22537597", "cg24794833", "cg17021218", "cg24466610", "cg06757048", "cg16214573", "cg18048953", "cg10856812", "cg27150598", "cg21604611", "cg16563691", "cg06452665", "cg23004758", "cg09387229", "cg05342987", "cg06924081", "cg04105230", "cg06467207", "cg03533472", "cg02783918", "cg00164282", "cg10692118", "cg23163279", "cg10632342", "cg26237255", "cg08692423", "cg16483867"]
# query_sub = "class_num == 5 & cg00002593 == 1 & cg08398233 == 0 & cg16573901 == 0 & cg00068503 == 0 & cg02756545 == 0 & cg09106948 == 0 & cg18887033 == 1 & cg09917591 == 2 & cg27591920 == 1 & cg03455424 == 1 & cg10914710 == 1 & cg19719391 == 1 & cg00070383 == 1 & cg14115785 == 2 & cg07666840 == 0 & cg21567625 == 0 & cg18197332 == 1 & cg19338277 == 0 & cg02639080 == 2 & cg11930353 == 2 & cg07028914 == 1 & cg03958979 == 0 & cg02645408 == 1 & cg00684125 == 1 & cg05769086 == 1 & cg22469355 == 0 & cg19978669 == 0 & cg15893356 == 1 & cg22537597 == 1 & cg24794833 == 1 & cg17021218 == 0 & cg24466610 == 1 & cg06757048 == 2 & cg16214573 == 0 & cg18048953 == 1 & cg10856812 == 1 & cg27150598 == 1 & cg21604611 == 1 & cg16563691 == 1 & cg06452665 == 1 & cg23004758 == 0 & cg09387229 == 1 & cg05342987 == 0 & cg06924081 == 1 & cg04105230 == 1 & cg06467207 == 1 & cg03533472 == 0 & cg02783918 == 1 & cg00164282 == 1 & cg10692118 == 0 & cg23163279 == 0 & cg10632342 == 1 & cg26237255 == 2 & cg08692423 == 0 & cg16483867 == 0"

## subgrupo 2
### cg23847017 = 0,cg11669516 = 0,cg17146473 = 2,cg08206623 = 1
# cols = ["cg23847017", "cg11669516", "cg17146473", "cg08206623", "class_num"]
# query_sub = "cg23847017 == 0 & cg11669516 == 0 & cg17146473 == 2 & cg08206623 == 1 & class_num == 5"

## subgrupo 3
### cg08146483 = 1,cg22931622 = 2
# cols = ["class_num", "cg08146483", "cg22931622"]
# query_sub = "class_num == 5 & cg08146483 == 1 & cg22931622 == 2"

## subgrupo 4
### cg07234569 = 1,cg10689175 = 0,cg15270654 = 1,cg06287003 = 2
# cols = ["class_num", "cg07234569", "cg10689175", "cg15270654", "cg06287003"]
# query_sub = "class_num == 5 & cg07234569 == 1 & cg10689175 == 0 & cg15270654 == 1 & cg06287003 == 2"

## subgrupo 5
### cg02193883 = 1,cg13272701 = 1,cg14263139 = 0,cg13573513 = 2,cg23010568 = 1
# cols = ["class_num", "cg02193883", "cg13272701", "cg14263139", "cg13573513", "cg23010568"]
# query_sub = "class_num == 5 & cg02193883 == 1 & cg13272701 == 1 & cg14263139 == 0 & cg13573513 == 2 & cg23010568 == 1"

## subgrupo 6
### cg22060611 = 0,cg18060909 = 2,cg26053068 = 1,cg22417613 = 1,cg00221747 = 2,cg12051439 = 1,cg24297365 = 0
# cols = ["class_num", "cg22060611", "cg18060909", "cg26053068", "cg22417613", "cg00221747", "cg12051439", "cg24297365"]
# query_sub = "class_num == 5 & cg22060611 == 0 & cg18060909 == 2 & cg26053068 == 1 & cg22417613 == 1 & cg00221747 == 2 & cg12051439 == 1 & cg24297365 == 0"

## subgrupo 7
### cg12045030 = 2,cg23708361 = 1,cg18001780 = 1,cg04739747 = 1
# cols = ["class_num", "cg12045030", "cg23708361", "cg18001780", "cg04739747"]
# query_sub = "class_num == 5 & cg12045030 == 2 & cg23708361 == 1 & cg18001780 == 1 & cg04739747 == 1"

## subgrupo 8
### cg17250929 = 2,cg20680819 = 1,cg17985646 = 1,cg05866545 = 2
# cols = ["class_num", "cg17250929", "cg20680819", "cg17985646", "cg05866545"]
# query_sub = "class_num == 5 & cg17250929 == 2 & cg20680819 == 1 & cg17985646 == 1 & cg05866545 == 2"

## subgrupo 9
### cg15797218 = 1,cg24825693 = 2,cg26618965 = 1
# cols = ["class_num", "cg15797218", "cg24825693", "cg26618965"]
# query_sub = "class_num == 5 & cg15797218 == 1 & cg24825693 == 2 & cg26618965 == 1"

## subgrupo 10
### cg21842916 = 2,cg13756932 = 1,cg20951642 = 2,cg22585927 = 0,cg13857707 = 0
cols = ["class_num", "cg21842916", "cg13756932", "cg20951642", "cg22585927", "cg13857707"]
query_sub = "class_num == 5 & cg21842916 == 2 & cg13756932 == 1 & cg20951642 == 2 & cg22585927 == 0 & cg13857707 == 0"

df = pd.read_csv(file, usecols=cols)
csv_df = pd.read_csv(csv, skiprows=1, names=["samples", "class", "class_num_2"])

df_merge = pd.concat([df, csv_df], axis=1)
df_subgroup = df_merge.query(query_sub)

samples = df_subgroup["samples"].to_list()
with open('samples_50_sg10.txt', 'w') as f:
    f.write("%s\n" % samples)